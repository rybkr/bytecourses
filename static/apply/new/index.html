<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Course Application - The Byte Course Project</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
    <header>
        <button id="hamburgerBtn" class="hamburger" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1>The Byte Course Project</h1>
        <nav id="mainNav" class="desktop-nav" style="display: none;">
            <button id="homeBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Home
            </button>
            <a href="/about/" id="aboutBtn"
                style="display: inline-flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); background: transparent; border: none; color: var(--color-text); text-decoration: none; cursor: pointer; border-radius: var(--radius-sm); font-size: 0.9375rem;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                About
            </a>
            <button id="viewCoursesBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Browse Courses
            </button>
            <a href="/apply/" id="submitCourseBtn"
                style="display: inline-flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); background: rgba(233, 30, 99, 0.1); border: none; color: var(--color-text); text-decoration: none; cursor: pointer; border-radius: var(--radius-sm); font-size: 0.9375rem;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Submit Course
            </a>
            <button id="myCoursesBtn" style="display: none;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                </svg>
                My Courses
            </button>
            <button id="profileBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                Profile
            </button>
            <button id="adminBtn" style="display: none;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24">
                    </path>
                </svg>
                Admin
            </button>
            <button id="logoutBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
            </button>
        </nav>
        <nav id="mobileNav" class="mobile-nav">
            <button id="mobileHomeBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Home
            </button>
            <a href="/about/" id="mobileAboutBtn"
                style="display: flex; align-items: center; gap: var(--spacing-sm); width: 100%; justify-content: flex-start; padding: var(--spacing-md) var(--spacing-lg); border-radius: var(--radius-sm); text-align: left; border-bottom: none; font-size: 0.9375rem; background: transparent; color: var(--color-text); text-decoration: none; cursor: pointer;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                About
            </a>
            <button id="mobileViewCoursesBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Browse Courses
            </button>
            <a href="/apply/" id="mobileSubmitCourseBtn"
                style="display: flex; align-items: center; gap: var(--spacing-sm); width: 100%; justify-content: flex-start; padding: var(--spacing-md) var(--spacing-lg); border-radius: var(--radius-sm); text-align: left; border-bottom: none; font-size: 0.9375rem; background: rgba(233, 30, 99, 0.1); color: var(--color-text); text-decoration: none; cursor: pointer;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Submit Course
            </a>
            <button id="mobileMyCoursesBtn" style="display: none;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                </svg>
                My Courses
            </button>
            <button id="mobileProfileBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                Profile
            </button>
            <button id="mobileAdminBtn" style="display: none;">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24">
                    </path>
                </svg>
                Admin
            </button>
            <button id="mobileLogoutBtn">
                <svg class="nav-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
            </button>
            <div id="mobileUserInfo" class="mobile-user-info"></div>
        </nav>
        <div id="mobileOverlay" class="mobile-overlay"></div>
        <div id="userInfo" class="user-info" style="display: none;"></div>
    </header>

    <main style="padding: var(--spacing-2xl) var(--spacing-xl);">
        <div id="authCheck" style="text-align: center; padding: var(--spacing-3xl);">
            <p>Checking authentication...</p>
        </div>

        <div id="formContent" style="display: none;">
            <div class="form-container" style="max-width: 800px;">
                <a href="/apply/" class="btn-secondary"
                    style="display: inline-flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-xl); text-decoration: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back to Portal
                </a>

                <h2>New Course Application</h2>
                <p style="color: var(--color-text-light); margin-bottom: var(--spacing-xl);">Create a course proposal
                    for
                    admin review. You can save your progress and return later.</p>

                <div id="draftPrompt" class="draft-prompt" style="display: none;">
                    <p><strong>You have a saved draft.</strong> Would you like to load it?</p>
                    <div class="draft-preview" id="draftPreview"></div>
                    <div class="button-group" style="margin-top: var(--spacing-md);">
                        <button type="button" id="loadDraftBtn" class="btn-secondary">Load Draft</button>
                        <button type="button" id="discardDraftBtn" class="btn-secondary">Start Fresh</button>
                    </div>
                </div>

                <div id="draftStatus" class="draft-status" style="display: none;"></div>

                <div id="formMessage" class="message" style="display: none; margin-bottom: var(--spacing-lg);"></div>

                <form id="applicationForm">
                    <div class="form-group">
                        <label for="title">Course Title *</label>
                        <input type="text" id="title" name="title" maxlength="255" required>
                        <div class="field-hint">Choose a clear, descriptive title for your course</div>
                        <div class="char-counter" id="titleCounter">0 / 255 characters</div>
                        <div class="field-error" id="titleError"></div>
                    </div>

                    <div class="form-group">
                        <label for="description">Description *</label>
                        <textarea id="description" name="description" rows="6" required></textarea>
                        <div class="field-hint">Provide a detailed description of what students will learn</div>
                        <div class="char-counter" id="descriptionCounter">0 characters</div>
                        <div class="field-error" id="descriptionError"></div>
                    </div>

                    <div class="form-group">
                        <label for="learningObjectives">Learning Objectives *</label>
                        <textarea id="learningObjectives" name="learningObjectives" rows="5" required></textarea>
                        <div class="field-hint">List what students will learn or achieve (one per line or bullet points)
                        </div>
                        <div class="char-counter" id="learningObjectivesCounter">0 characters</div>
                        <div class="field-error" id="learningObjectivesError"></div>
                    </div>

                    <div class="form-group">
                        <label for="prerequisites">Prerequisites</label>
                        <textarea id="prerequisites" name="prerequisites" rows="4"></textarea>
                        <div class="field-hint">What knowledge or skills should students have before taking this course?
                        </div>
                        <div class="char-counter" id="prerequisitesCounter">0 characters</div>
                        <div class="field-error" id="prerequisitesError"></div>
                    </div>

                    <div class="form-group">
                        <label for="courseFormat">Course Format *</label>
                        <select id="courseFormat" name="courseFormat" required>
                            <option value="">Select a format...</option>
                            <option value="live-sessions">Live Sessions</option>
                            <option value="self-paced">Self-paced</option>
                            <option value="hybrid">Hybrid</option>
                            <option value="workshop">Workshop</option>
                        </select>
                        <div class="field-error" id="courseFormatError"></div>
                    </div>

                    <div class="form-group">
                        <label for="categoryTags">Category/Tags</label>
                        <input type="text" id="categoryTags" name="categoryTags" maxlength="200">
                        <div class="field-hint">Enter categories or tags separated by commas (e.g., Web Development,
                            Python, Data Science)</div>
                        <div class="char-counter" id="categoryTagsCounter">0 / 200 characters</div>
                        <div class="field-error" id="categoryTagsError"></div>
                    </div>

                    <div class="form-group">
                        <label for="skillLevel">Skill Level *</label>
                        <select id="skillLevel" name="skillLevel" required>
                            <option value="">Select a level...</option>
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                        <div class="field-error" id="skillLevelError"></div>
                    </div>

                    <div class="form-group">
                        <label for="courseDuration">Course Duration</label>
                        <input type="text" id="courseDuration" name="courseDuration" maxlength="100">
                        <div class="field-hint">Estimated duration (e.g., '4 weeks', '10 hours', '5 sessions')</div>
                        <div class="char-counter" id="courseDurationCounter">0 / 100 characters</div>
                        <div class="field-error" id="courseDurationError"></div>
                    </div>

                    <div class="form-group">
                        <label for="instructorQualifications">Instructor Qualifications</label>
                        <textarea id="instructorQualifications" name="instructorQualifications" rows="4"></textarea>
                        <div class="field-hint">Briefly describe your qualifications or experience relevant to teaching
                            this course</div>
                        <div class="char-counter" id="instructorQualificationsCounter">0 characters</div>
                        <div class="field-error" id="instructorQualificationsError"></div>
                    </div>

                    <div class="button-group">
                        <button type="button" id="saveDraftBtn" class="btn-secondary">Save Draft</button>
                        <button type="submit" id="submitBtn" class="btn-primary">Submit for Approval</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="loginPrompt"
            style="display: none; text-align: center; padding: var(--spacing-3xl); max-width: 500px; margin: 0 auto;">
            <h2>Login Required</h2>
            <p style="color: var(--color-text-light); margin-bottom: var(--spacing-xl);">You need to be logged in to
                create a course application.</p>
            <a href="/" class="btn-primary" style="display: inline-block; text-decoration: none;">Go to Home</a>
        </div>
    </main>

    <script src="/static/js/api.js"></script>
    <script src="/static/js/navbar.js"></script>
    <script src="/static/js/apply-new.js"></script>
    <script>
        async function checkAuthAndInit() {
            const authCheck = document.getElementById("authCheck");
            const formContent = document.getElementById("formContent");
            const loginPrompt = document.getElementById("loginPrompt");

            const token = sessionStorage.getItem("authToken");
            if (!token) {
                authCheck.style.display = "none";
                loginPrompt.style.display = "block";
                return;
            }

            try {
                const payload = navbarModule.parseJWT(token);
                if (!payload) {
                    authCheck.style.display = "none";
                    loginPrompt.style.display = "block";
                    return;
                }

                if (payload.exp && payload.exp * 1000 < Date.now()) {
                    authCheck.style.display = "none";
                    loginPrompt.style.display = "block";
                    return;
                }

                authCheck.style.display = "none";
                formContent.style.display = "block";

                applyNewModule.init();
            } catch (error) {
                authCheck.style.display = "none";
                loginPrompt.style.display = "block";
            }
        }

        document.addEventListener("DOMContentLoaded", checkAuthAndInit);
    </script>
</body>

</html>