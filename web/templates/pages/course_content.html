{{template "layout" .}} {{define "title"}}{{.Course.Title}} - Content - ByteCourses{{end}} {{define "content"}}
{{template "course-navbar" .}}

<div class="course-content-container">
    <div class="course-content-sidebar">
        <nav class="course-content-nav" aria-label="Course outline">
            <div class="course-content-sidebar-header">
                <h3>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    Table of contents
                </h3>
                {{if .Modules}}
                <div class="course-content-expand-actions">
                    <button type="button" class="course-content-expand-btn" id="expand-all-btn" aria-label="Expand all modules">Expand all</button>
                    <span class="course-content-expand-sep" aria-hidden="true">Â·</span>
                    <button type="button" class="course-content-expand-btn" id="collapse-all-btn" aria-label="Collapse all modules">Collapse all</button>
                </div>
                {{end}}
            </div>
            <div class="course-content-modules">
                <a href="/courses/{{.Course.ID}}/modules" class="course-content-overview-link active">Overview</a>
                {{if .Modules}}
                {{range $moduleIndex, $module := .Modules}}
                {{$readings := index $.ReadingsByModule $module.ID}}
                {{$moduleNum := add $moduleIndex 1}}
                <div class="course-content-module{{if $.CurrentModule}}{{if eq $module.ID $.CurrentModule.ID}} active{{end}}{{end}}"
                    data-module-id="{{$module.ID}}" data-course-id="{{$.Course.ID}}" data-module-status="{{$module.Status}}">
                    <div class="course-content-module-header-wrapper">
                        <div class="module-number">{{$moduleNum}}</div>
                        <div class="module-info">
                            <a href="/courses/{{$.Course.ID}}/modules/{{$module.ID}}" class="module-card-title-link" title="View module">
                                <span class="module-card-title">{{$module.Title}}</span>
                            </a>
                            <div class="module-meta">
                                <span class="module-card-count">{{if $readings}}{{len $readings}} item{{if gt (len $readings) 1}}s{{end}}{{else}}No content{{end}}</span>
                                {{if $.IsInstructor}}
                                <span class="module-status-badge module-status-{{$module.Status}}">{{$module.Status}}</span>
                                {{end}}
                            </div>
                        </div>
                        {{if $.IsInstructor}}
                        <div class="module-actions-menu">
                            <button type="button" class="module-menu-trigger" aria-label="Module options" aria-expanded="false">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="5" r="1"></circle>
                                    <circle cx="12" cy="12" r="1"></circle>
                                    <circle cx="12" cy="19" r="1"></circle>
                                </svg>
                            </button>
                            <div class="module-menu-dropdown">
                                {{if eq $module.Status "draft"}}
                                <button type="button" class="module-menu-item module-publish-btn" data-course-id="{{$.Course.ID}}" data-module-id="{{$module.ID}}">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                    Publish
                                </button>
                                {{end}}
                                <button type="button" class="module-menu-item module-delete-btn" data-course-id="{{$.Course.ID}}" data-module-id="{{$module.ID}}">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="3 6 5 6 21 6"></polyline>
                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    </svg>
                                    Delete
                                </button>
                            </div>
                        </div>
                        {{end}}
                        <button type="button" class="course-content-module-toggle" aria-expanded="false" aria-controls="module-{{$module.ID}}-content" aria-label="Expand module {{$module.Title}}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div class="course-content-module-content" id="module-{{$module.ID}}-content">
                        {{if $readings}}
                        <div class="course-content-readings">
                            {{range $readingIndex, $reading := $readings}}
                            {{$readingNum := printf "%d.%d" $moduleNum (add $readingIndex 1)}}
                            <div class="course-content-reading-row" data-course-id="{{$.Course.ID}}"
                                data-module-id="{{$module.ID}}" data-reading-id="{{$reading.ID}}"
                                data-status="{{$reading.Status}}">
                                <a href="/courses/{{$.Course.ID}}/modules/{{$module.ID}}/content/{{$reading.ID}}"
                                    class="course-content-reading{{if $.CurrentReading}}{{if eq $reading.ID $.CurrentReading.ID}} active{{end}}{{end}}">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                        <polyline points="14 2 14 8 20 8"></polyline>
                                        <line x1="16" y1="13" x2="8" y2="13"></line>
                                        <line x1="16" y1="17" x2="8" y2="17"></line>
                                    </svg>
                                    <span class="reading-order">{{$readingNum}}</span>
                                    <span>{{$reading.Title}}</span>
                                </a>
                                {{if $.IsInstructor}}
                                <div class="course-content-reading-actions">
                                    <span class="content-status-badge content-status-{{$reading.Status}}">{{$reading.Status}}</span>
                                    {{if eq $reading.Status "draft"}}
                                    <button type="button" class="btn btn-small btn-success sidebar-publish-btn">Publish</button>
                                    {{else}}
                                    <button type="button" class="btn btn-small btn-secondary sidebar-unpublish-btn">Unpublish</button>
                                    {{end}}
                                </div>
                                {{end}}
                            </div>
                            {{end}}
                        </div>
                        {{else}}
                        <div class="module-empty-state">
                            <svg class="module-empty-state-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                            </svg>
                            <p class="text-muted">No readings yet</p>
                            {{if $.IsInstructor}}
                            <a href="/courses/{{$.Course.ID}}/modules/{{$module.ID}}/content/new"
                                class="btn btn-small btn-primary">Add Reading</a>
                            {{end}}
                        </div>
                        {{end}}
                    </div>
                </div>
                {{end}}
                {{else}}
                <div class="empty-state">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                        stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    {{if .IsInstructor}}
                    <p>No modules yet</p>
                    <span class="text-muted">Create your first module below</span>
                    {{else}}
                    <p>No content available</p>
                    <span class="text-muted">Check back later</span>
                    {{end}}
                </div>
                {{end}}
                {{if .IsInstructor}}
                <div class="add-module-section">
                    <button type="button" class="add-module-trigger" id="add-module-btn" aria-label="Add a new module">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        <span>Add module</span>
                    </button>
                    <div class="add-module-form" id="new-module-form" style="display: none;">
                        <input type="text" class="inline-input" placeholder="Module title" required>
                        <textarea class="inline-textarea" placeholder="Description (optional)" rows="2"></textarea>
                        <div class="inline-actions">
                            <button type="button" class="btn btn-small btn-primary btn-create-module">Create</button>
                            <button type="button" class="btn btn-small btn-ghost btn-cancel-new-module">Cancel</button>
                        </div>
                    </div>
                </div>
                {{end}}
            </div>
        </nav>
    </div>

    <div class="course-content-main">
        <div class="course-content-overview">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
            <h1>Course Content</h1>
            <p class="text-muted">Select a module from the sidebar to view its content, or expand a module to see
                individual readings.</p>
        </div>
    </div>
</div>

{{end}} {{define "scripts"}}
<script type="module" src="/static/js/pages/course_content.js"></script>
{{end}}