{{template "layout" .}} {{define "title"}}{{.Reading.Title}} - {{.Course.Title}} - ByteCourses{{end}} {{define "content"}}
{{template "course-navbar" .}}

<div class="lecture-view-container">
    <div class="lecture-view-header">
        <nav class="lecture-view-breadcrumb" aria-label="Breadcrumb">
            <a href="/courses/{{.Course.ID}}/modules">{{.Course.Title}}</a>
            <span class="breadcrumb-sep" aria-hidden="true">/</span>
            <a href="/courses/{{.Course.ID}}/modules/{{.Module.ID}}">{{.Module.Title}}</a>
            <span class="breadcrumb-sep" aria-hidden="true">/</span>
            <span>{{.Reading.Title}}</span>
        </nav>
        <div class="lecture-view-title-row">
            <h1 class="lecture-view-title">{{.Reading.Title}}</h1>
            {{if .IsInstructor}}
            <div class="lecture-view-meta">
                <span class="content-status-badge content-status-{{.Reading.Status}}">{{.Reading.Status}}</span>
                {{if eq .Reading.Status "draft"}}
                <button type="button" id="publish-btn" class="btn btn-sm btn-success">Publish</button>
                {{else}}
                <button type="button" id="unpublish-btn" class="btn btn-sm btn-outline">Unpublish</button>
                {{end}}
            </div>
            {{end}}
        </div>
    </div>

    <div class="lecture-view-content">
        {{with deref .Reading.Content}}
        {{if eq $.Reading.Format "markdown"}}
        <div class="proposal-content-value">{{markdown .}}</div>
        {{else if eq $.Reading.Format "html"}}
        <div class="proposal-content-value">{{sanitizeHTML .}}</div>
        {{else}}
        <div class="proposal-content-value">
            <pre style="white-space: pre-wrap;">{{.}}</pre>
        </div>
        {{end}}
        {{else}}
        <p class="text-muted">No content available yet.</p>
        {{end}}
    </div>

    <nav class="course-page-actions" aria-label="Content navigation">
        <a href="/courses/{{.Course.ID}}/modules/{{.Module.ID}}" class="btn btn-outline course-page-actions-back">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="15 18 9 12 15 6"></polyline></svg>
            Back to module
        </a>
        <a href="/courses/{{.Course.ID}}/modules" class="btn btn-outline">Content</a>
        {{if .IsInstructor}}
        <a href="/courses/{{.Course.ID}}/modules/{{.Module.ID}}/content/{{.Reading.ID}}/edit" class="btn btn-primary">Edit reading</a>
        {{end}}
    </nav>
</div>

<script>
    window.LECTURE_VIEW_DATA = { courseId: {{.Course.ID}}, moduleId: {{.Module.ID}}, readingId: {{.Reading.ID}} };
</script>
{{end}}

{{define "scripts"}}
<script type="module" src="/static/js/pages/lecture_view.js"></script>
{{end}}